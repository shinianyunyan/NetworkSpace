第一章 用户信息接口
0x01 用户信息-获取接口
接口地址：/api/v3/user/info
请求方式：GET
接口描述：​ 获取用户详情
接口参数：
​ Headers

字段	类型	必填	示例	备注
X-QuakeToken	str	是	d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx	用户API调用私钥
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/user/info" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {

    
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(url="https://quake.360.net/api/v3/user/info", headers=headers)
print(response.json())
返回值范例
{
  "code": 0,
  "message": "Successful",
  "data": {
    "id": "5ea7e45147bc09xxxxxxxxcb",
    "user": {
      "id": "5ea7e45147bc09xxxxxxxxc8",
      "username": "xxxxxxx",
      "fullname": "XX",
      "email": "xxxxxx@360.cn"
    },
    "baned": false,
    "ban_status": "使用中",
    "credit": 5000,
    "persistent_credit": 1000,
    "token": "xxxx-xxxx",
    "mobile_phone": "",
    "source": "quake",
    "privacy_log": {
      "status": false,
      "time": null
    },
    "enterprise_information": {
      "name": null,
      "email": null,
      "status": "未认证"
    },
    "personal_information_status": false,
    "role": [
      {
        "fullname": "注册用户",
        "priority": 4,
        "credit": 3000
      }
    ]
  },
  "meta": {}
}


第2章 查询语句
2.1 检索关键词
为了能够充分利用好本系统，了解我们检索查询语法是至关重要的。 本文将介绍一下入门基础知识。

在深入研究实际的搜索查询语法之前，让我们看一下将在 Quake 中搜索的内容：

0x01 端口响应信息（Response）
互联网上各类设备需要通信一定依赖各类网络协议，Quake 具备对数千种常见网络协议识别、采集的能力。

例如，常见的网站一般运行在 Web 服务的设备上，Quake 将通过与该 Web 服务器建立正常的 HTTP 连接来收集信息。

每个服务的在建立连接后返回的信息都存储在称为 response 的对象中。 这是整个空间测绘系统收集的基本数据单位以及检索的内容主体。

0x02 模糊搜索
在默认状态下，用户在搜索框里输入的任何内容均会与 端口响应 中的内容匹配

0x03 分词现象
当我们搜索的内容变成中文或者包含空格的一句话时，如果像上述操作一样会产生 错误 的结果：

在输入框中检索：奇虎科技，会发现返回的结果虽然有 59 万多，但是没有一个是包含完整且连贯的奇虎科技字符串的
其实原因就是我们输入的 奇虎科技 被拆分成了： 奇虎 和 科技 ，那么如果在端口响应中包含 科技 两个字，则会被认为是能够匹配的。

那么为了避免这个问题，我们强烈建议对需要检索的中文信息和包含空格的字符串使用英文双引号 " " 包裹：

0x04 基本检索语法
port: 443：查询 443 端口
port: 3389 AND country:"China"：查询在 China 的 3389 端口
port: 3389 AND country_cn: "中国" AND NOT province_cn: "广东"：查询在 中国 且不在 广东省 所有的 3389 端口
port: 3389 AND (country:"China" OR country: "United State") AND NOT province_cn: "广东"：查询在 China 或者 United States 且不在 广东省 的所有 3389 端口
port: 80 AND NOT response:"baidu"：查询 80 端口且返回数据包不包括 baidu 字样的服务

0x05 基本信息字段查询
检索语法	字段名称	支持的数据模式	解释说明	范例
ip	IP 地址及网段	主机数据
服务数据
支持检索单个 IP、CIDR 地址段、支持 IPv6 地址	ip:"1.1.1.1"
ip: "1.1.1.1/16"
ip:"2804:29b8:500d:4184:40a8:2e48:9a5d:e2bd"
ip:"2804:29b8:500d:4184:40a8:2e48:9a5d:e2bd/24"
is_ipv6	搜索 ipv4 的资产	主机数据
服务数据
只接受 true 和 false	is_ipv6:"true" ：查询 IPv6 数据
is_ipv6:"false" ：查询 IPv4 数据
is_latest	搜索最新的资产	服务数据	只接受 true 和 false	is_latest :"true" ：查询最新的资产数据
port	端口	主机数据
服务数据
搜索开放的端口	port:"80" ：查询开放 80 端口的主机
ports	多端口	主机数据	搜索某个主机同时开放过的端口	ports:"80,8080,8000" ：查询同时开放过 80、8080、8000 端口的主机
port:>或<
port:>=或<=	端口范围	主机数据
服务数据	搜索满足某个端口范围的主机	port:[* TO 80] ：查询开放端口小于等于 80 的主机
port:[80 TO 1024] ：查询开放的端口介入 80 和 1024 之间的主机
port:[80 TO *] ：查询开放端口包含且大于 80 端口的主机
transport	传输层协议	主机数据
服务数据
只接受 tcp、udp	transport:"tcp" ：查询 tcp 数据
transport:"udp" ：查询 udp 数据
0x06 ASN 网络自治域相关部分
检索语法	字段名称	支持的数据模式	解释说明	范例
asn	自治域号码	主机数据
服务数据
自治域号码	asn:"12345"
org	自治域归属组织名称	主机数据
服务数据
自治域归属组织名称	org:"No.31,Jin-rong Street"
0x07 主机名与操作系统部分
检索语法	字段名称	支持的数据模式	解释说明	范例
hostname	主机名	服务数据	即 rDNS 数据	hostname:"50-87-74-222.unifiedlayer.com"
domain	网站域名	服务数据	网站域名信息	domain:"360.cn"
domain:*.360.cn
os	操作系统部分	服务数据	操作系统名称+版本	os:"Windows"
0x08 服务数据部分
检索语法	字段名称	支持的数据模式	解释说明	范例
service	服务名称	主机数据
服务数据	即应用协议名称	service:"http"
services	多个服务名称	主机数据	搜索某个主机同时支持的协议
仅在 主机数据 模式下可用	services:"rtsp,https,telnet" ：支持 rtsp、https、telnet 的主机
app	服务产品	主机数据
服务数据	经过 Quake 指纹识别后的产品名称（未来会被精细化识别产品替代）	app:"Apache" Apache 服务器产品
app_version	产品版本	主机数据
服务数据	经过 Quake 指纹识别后的产品版本	app_version:"1.2.1"
response	服务原始响应	服务数据	这里是包含端口信息最丰富的地方	response:"奇虎科技" ：端口原生返回数据中包含"奇虎科技"的主机
response:"220 ProFTPD 1.3.5a Server" ：端口原生返回数据中包含"220 ProFTPD 1.3.5a Server"字符串的主机
cert	SSL\TLS 证书信息	主机数据
服务数据	这里存放了格式解析后的证书信息字符串	cert:"奇虎科技" ：包含"奇虎科技"的证书
cert:"360.cn" ：包含"360.cn"域名的证书
domain:"XXX.com" AND cert:"XXX\.com" ：模糊搜索证书是XXX域名的资产
0x09 精细化应用识别部分
检索语法	字段名称	支持的数据模式	解释说明	范例(搜索内容对应网页上方的产品页面内容)
catalog	应用类别	服务数据	该字段是应用类型的集合，是一个更高层面应用的聚合	catalog:"IoT物联网"
catalog:"IoT物联网" OR catalog:"网络安全设备"
type	应用类型	服务数据	该字段是对应用进行的分类结果，指一类用途相同的资产	type:"防火墙"
type:"VPN"
level	应用层级	服务数据	对于所有应用进行分级，一共 5 个级别：硬件设备层、操作系统层、服务协议层、中间支持层、应用业务层	level:"硬件设备层"
level:"应用业务层"
vendor	应用生产厂商	服务数据	该字段指某个应用设备的生产厂商	vendor:"Sangfor深信服科技股份有限公司"
vendor:"Sangfor" OR vendor:"微软"
vendor:"DrayTek台湾居易科技"
0x10 IP 归属与定位部分
检索语法	字段名称	支持的数据模式	解释说明	范例
country	国家（英文）与国家代码	主机数据、服务数据	搜索 country: C hina country: CN 都可以	country:"China" country:"CN"
country_cn	国家（中文）	主机数据、服务数据	用于搜索中文国家名称	country_cn:"中国"
province	省份（英文）	主机数据、服务数据	用于搜索英文省份名称	province:"Sichuan"
province_cn	省份（中文）	主机数据、服务数据	用于搜索中文省份名称	province_cn:"四川"
city	城市（英文）	主机数据、服务数据	用于搜索英文城市名称	city:"Chengdu"
city_cn	城市（中文）	主机数据、服务数据	用于搜索中文城市名称	city_cn:"成都"
district	区县（中文）	服务数据	用于搜索中文城市下面的区县名称	district:"朝阳区"
owner	IP 归属单位	主机数据、服务数据	这里的归属并不精确，后期 Quake 会推出单位归属专用关键词	owner: "tencent.com" owner: "清华大学"
isp	运营商	主机数据、服务数据	根据 IP 划分归属的运营商	isp: "联通"
isp: "amazon.com"
0x11 图像数据与应用场景部分
检索语法	字段名称	解释说明	范例
img_tag	图片标签	用于搜索图片的标签	img_tag: "windows" img_tag: "web_login" img_tag: "webcam" img_tag: "停车场" img_tag: "汽车" img_tag: "树木" img_tag: "广告牌" img_tag: "人" img_tag: "摩托车" img_tag: "自行车" img_tag: "机器人" img_tag: "工具"
img_ocr	图片 OCR	用于搜索图片中的信息	img_ocr:"admin" img_ocr:"windows" img_ocr:"login" img_ocr:"root"
sys_tag	系统标签	用于搜索 IP 资产的应用场景，如：CDN、卫星互联网、IDC 机房等	sys_tag:"卫星互联网" sys_tag:"CDN" sys_tag:"IDC" sys_tag:"机房"
0x12 http
协议说明
http 是一个简单的请求-响应协议, 它通常运行在 TCP 之上。

字段说明
字段	字段含义	搜索语法示例
status_code	http 返回状态码	status_code:200
http_path	http 请求路径	http_path:"/admin"
title	网页标题	title:"后台"
meta_keywords	网页关键字	meta_keywords:"网络安全"
server	Web 服务器名称（http headers 里面的 Server 字段）	server:Nginx
service.http.server.keyword	Web 服务器名称（精确查找）	service.http.server.keyword: "Apache/2.4.29"
x_powered_by	网站开发语言（http headers 里面的 X-Powered-By）	powered_by:PHP
favicon	网页 favicon 的 md5 值	favicon:"0488faca4c19046b94d07c3ee83cf9d6"
host	请求 host 的值	host:"google.com"
html_hash	网页 html 的 md5 值	html_hash:"69d7683445fed9e517e33750615f46c0"
headers	http headers 字符串	headers:"ThinkPHP"
header_order_hash	HTTP 头部所有 key 用英文逗号按序连接后取 MD5	header_order_hash:"42997ea42eb46037ecb1e514e8190b93"
body	网页 body 内容	body:"奇虎"
robots_hash	robots.txt 的 md5 值	robots_hash:"e4c3bfe695710c5610cf51723b3bdae2"
robots	robots.txt 的内容	robots:"Discuz"
sitemap_hash	sitemap.xml 的 md5 值	sitemap_hash:10f3aa0c1bd43f07ef8ed178d8b97df1
sitemap	sitemap.xml 的内容	sitemap:"archive"
cookie_simhash	cookie key 的 simhash 值	cookie_simhash:"16149686953955343636"
cookie_order_hash	Cookie 所有 key 用英文逗号拼接后的 MD5	cookie_order_hash:"6ccfd3351761d2ac11b0963d916197e0"
dom_tree.simhash	DOM 树节点的 simhash	dom_simhash:"13136671156032164472"
dom_tree.key	DOM 树所有元素集合，英文逗号连接	dom_node:"html,head,body"
dom_tree.dom_hash	DOM 树所有元素的哈希	dom_hash:"38d8daf979e511dfe3a421abe4f36561"
script_function	script 标签中的函数名	script_function:"func1"
script_variable	srcipt 标签中的变量名	script_variable:"csrfToken"
css_class	css 标签 class 字段值	css_class:"center"
css_id	css 标签 id 字段值	css_id:"login"
url_load	HTTP 加载流，不包含静态资源。	url_load:"/bim/"
icp	ICP 备案号	icp:"京ICP备08010314号"
copyright	版权许可	copyright:" 360网络安全响应中心（360-CERT）"
mail	邮箱地址	mail:"@163.com"
page_type	页面类型	page_type:"登录页"
iframe_url	iframe 链接	iframe_url:"https://open.work.weixin.qq.com/wwopen/sso/v1/"
iframe_hash	frame url 内容的 md5 值	iframe_hash:"8c82d234e800eecbc2ff092905059cc3"
iframe_title	iframe 链接标题	iframe_title:"企业微信登录"
iframe_keywords	iframe 链接关键字	iframe_keywords:"电力能源"
domain_is_wildcard:	是否存在泛解析域名的字段标签	domain_is_wildcard:true
is_domain:	是否存在域名的关键词	is_domain:true
icp_nature:	查询备案主体性质	icp_nature:"企业"（政府机关、事业单位、群团组织、群众性团体组织、社会团体、民办非企业单位、民办非企业、律师执业机构、律师事务所、宗教团体、外国机构、外国文化中心、外国在华文化中心、境外机构、基金会、国防机构、司法鉴定机构、司法鉴定所、医疗机构、军队、公证机构、公正机构、仲裁机构、个人）
icp_keywords:	查询备案网站中的关键词或域名	icp_keywords:"奇虎"
_exists_:service.http.icp	是否存在 icp 备案	and _exists_:service.http.icp and not _exists_:service.http.icp
0x13 ftp
协议说明
文件传输协议（File Transfer Protocol，FTP）是用于在网络上进行文件传输的一套标准协议。

字段说明
字段	字段含义	搜索语法示例
is_anonymous	是否可匿名登录	service.ftp.is_anonymous:true
0x14 rsync
协议说明
rsync 数据备份 Remote Sync : 简称 rsync, 是一种远程同步, 高效的数据备份的工具。

字段说明
字段	字段含义	搜索语法示例
authentication	是否开启权限验证	service.rsync.authentication:false
0x15 ssh
协议说明
SSH 为 Secure Shell 的缩写，由 IETF 的网络小组（Network Working Group）所制定；SSH 为建立在应用层基础上的安全协议。SSH 是较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用 SSH 协议可以有效防止远程管理过程中的信息泄露问题。

字段说明
字段	字段含义	搜索语法示例
server_keys.type	加密类型	service.ssh.server_keys.type:"ssh-rsa"
server_keys.fingerprint	ssh host_key 指纹	service.ssh.server_keys.fingerprint:"3c:14:84:40:c5:f3:d3:82:70:95:9f:91:bf:5f:a7:63"
ciphers	允许使用的加密算法	service.ssh.ciphers:"aes128-ctr"
kex		service.ssh.kex:"ecdh-sha2-nistp256"
digests		service.ssh.digests:"hmac-sha2-256"
key_types		service.ssh.key_types:"ssh-rsa"
compression		
0x16 upnp
协议说明
通用即插即用（英语：Universal Plug and Play，简称 UPnP）是由“通用即插即用论坛”（UPnP™ Forum）推广的一套网络协议。该协议的目标是使家庭网络（数据共享、通信和娱乐）和公司网络中的各种设备能够相互无缝连接，并简化相关网络的实现。

字段说明
字段	字段含义	搜索语法示例
deviceType	设备类型	
friendlyName	友好的设备名	service.upnp.friendlyName:"RX SR-DBU"
manufacturer	制造商	service.upnp.manufacturer:"D-LINK"
manufacturerURL	制造商官网	
modelDescription	模块描述	service.upnp.modelDescription:"WLAN"
modelName	模块名称	service.upnp.modelName:"WRC"
modelNumber	模块型号	service.upnp.modelNumber:"EV"
0x17 snmp
协议说明
简单网络管理协议（SNMP） 是专门设计用于在 IP 网络管理网络节点（服务器、工作站、路由器、交换机及 HUBS 等）的一种标准协议，它是一种应用层协议。

字段说明
字段	字段含义	搜索语法示例
sysname	系统名、设备标识、主机名	service.snmp.sysname:"CableHome"
sysdesc	设备描述、系统基本信息	service.snmp.sysdesc:"TC7200"
sysuptime	进程从启动开始的时间长度	service.snmp.sysuptime:"22230600"
syslocation	启用了 SNMP Agent 的设备的位置	service.snmp.syslocation:"HUMAX"
syscontact	设备管理联系人信息	service.snmp.syscontact:"SNMPv2"
sysobjectid	设备标识	service.snmp.sysobjectid:"1.3.6.1.4.1.8072.3.2.10"
0x18 docker
协议说明
Docker 是一个开源的应用容器引擎, 基于 Go 语言 并遵从 Apache2.0 协议开源。

字段说明
字段	字段含义	搜索语法示例
docker.containers.Image	镜像名	service.docker.containers.Image:"ubuntu"
docker.containers.Command	启动命令	service.docker.containers.Command:"wget"
version.Version	docker 版本	service.docker.version.Version:"19.03.1"
version.ApiVersion	docker api 版本	service.docker.version.ApiVersion:"1.40"
version.MinAPIVersion	服务器支持的最低 API 版本	service.docker.version.MinAPIVersion:"1.12"
version.GitCommit	Git 提交标识符	service.docker.version.GitCommit:"74b1e89"
version.GoVersion	用于编译 docker 的 golang 版本	service.docker.version.GoVersion:"go1.12.5"
version.Arch	运行服务的服务器的体系架构	service.docker.version.Arch:"arm"
verson.KernelVersion	服务器的内核版本	service.docker.version.KernelVersion:"3.10.70"
version.BuildTime	创建生成的日期和时间	service.docker.version.BuildTime:"2018-04-26T07:46:45.000000000+00:00"
0x19 dns
协议说明
域名系统（服务）协议（DNS）是一种分布式网络目录服务，主要用于域名与 IP 地址的相互转换。

字段说明
字段	字段含义	搜索语法示例
id_server		service.domain.id_server:"pdns"
version_bind	dns 服务器版本信息	service.domain.version_bind:"Freenom"
0x20 elastic
协议说明
Elasticsearch 是一个基于 Lucene 的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web 接口。

字段说明
字段	字段含义	搜索语法示例
indices.health	服务器健康状态	service.elastic.indices.health:"green"
indices.status	服务器状态	service.elastic.indices.status:"open"
indices.index	索引名	service.elastic.indices.index:"user"
indices.uuid	uuid	
indices.docs_count	文档数量	service.elastic.indices.docs_count:"993"
indices.store_size	存储容量	service.elastic.indices.store_size:"945.4kb"
0x21 hive
协议说明
hive 是基于 Hadoop 的一个数据仓库工具，用来进行数据提取、转化、加载，这是一种可以存储、查询和分析存储在 Hadoop 中的大规模数据的机制。

字段说明
字段	字段含义	搜索语法示例
hive_dbs.dbname	数据库名	service.hive.hive_dbs.dbname:"default"
hive_dbs.tables	表名	service.hive.hive_dbs.tables:"user"
0x22 mongodb
协议说明
MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。

字段说明
字段	字段含义	搜索语法示例
authentication	是否开启授权	service.mongodb.authentication:false
buildInfo.version	mongo 版本	service.mongodb.buildInfo.version:"4.0.6"
buildInfo.gitVersion	用于标识用于生成 mongod 的代码状态的提交标识符	service.mongodb.buildInfo.gitVersion:"caa42a1f75a56c7643d0b68d3880444375ec42e3"
buildinfo.OpenSSLVersion	openssl 版本	
buildinfo.sysInfo	一个字符串，包含用于编译 mongod 的操作系统、主机名、内核、日期和 Boost 版本的信息	
buildinfo.loaderFlags	传递给加载 mongod 的加载程序的标志	
buildinfo.compilerFlags	传递给生成 mongod 二进制文件的编译器的标志	
buildinfo.allocator	mongod 使用的内存分配器	
buildinfo.versionArray	传递 mongod 实例版本信息的数组	
service.mongodb.buildinfo.javascriptEngine	报告 mongod 实例中使用的 JavaScript 引擎的字符串	
buildinfo.bits	反映 mongod 二进制文件的目标处理器体系结构的数字	
buildinfo.debug	是否调试模式	
buildinfo.maxBsonObjectSize	报告最大 BSON 文档大小的数字	
serverStatus.host	mongo 服务器 host	service.mongodb.serverStatus.host:"q361"
serverStatus.process	mongo 服务器进程名	service.mongodb.serverStatus.process:"mongod"
serverStatus.pid	mongo 服务进程 pid	service.mongodb.serverStatus.pid:3666
serverStatus.connections.current	当前连接数	service.mongodb.serverStatus.connections.current:34
serverStatus.connections.available	可用的连接	service.mongodb. serverStatus.connections.available:6519
serverStatus.connections.totalCreated	总计创建的连接数	service.mongodb.serverStatus.connections.totalCreated:95362
listDatabases.databases.name	数据库名	service.mongodb.listDatabases.databases.name:"admin"
listDatabases.databases.sizeOnDisk	数据大小	service.mongodb.listDatabases.databases.sizeOnDisk:"83886080.0"
listDatabases.totalSize	数据库大小	service.mongodb.listDatabases.totalSize:"103098089472"
0x23 ethernetip
协议说明
工业以太网协议 (Ethernet/IP) 是由 ODVA 所开发并得到了罗克韦尔自动化的强大支持。它使用已用于 ControlNet 和 DeviceNet 的控制和信息协议 (CIP) 为应用层协议。

字段说明
字段	字段含义	搜索语法示例
product_name	产品名	service.ethernetip.product_name:1763-L16BWA
product_code	产品代码	service.ethernetip.product_code:185
device_ip	设备 IP	service.ethernetip.device_ip:"192.168.1.10"
vendor	制造商信息	service.ethernetip.vendor:"Rockwell Automation"
revision	修订版本号	service.ethernetip.revision:"2.15"
serial_num	设备序列号	service.ethernetip.serial_num:"0x40651da9"
0x24 modbus
协议说明
Modbus 是一种串行通信协议，是 Modicon 公司（现在的施耐德电气 Schneider Electric）于 1979 年为使用可编程逻辑控制器（PLC）通信而发表。

字段说明
字段	字段含义	搜索语法示例
UnitId	单元 id	service.modbus.UnitId:1
DeviceIdentification	设备信息	service.modbus.DeviceIdentification:"Schneider Electric"
SlaveIDdata	从站 ID 数据	service.modbus.SlaveIDdata:"tMCB"
CpuModule	CPU 型号	service.modbus.CpuModule:"BMX"
MemoryCard	设备存储卡信息	service.modbus.MemoryCard:"BMXRMS008MP"
ProjectInfo.Project_Revision	修订版本	
ProjectInfo.ProjectLastModified	最后更改时间	
ProjectInfo.ProjectInformation	项目信息	
0x25 s7
协议说明
S7 通信协议是西门子 S7 系列 PLC 内部集成的一种通信协议。

字段说明
字段	字段含义	搜索语法示例
Module	模块	service.s7.Module:"6ES7"
Basic_Hardware	硬件信息	service.s7.Basic_Hardware:"6ES7"
Basic_Firmware	固件信息	service.s7.Basic_Firmware:"6ES7"
Name_of_the_PLC	可编程逻辑控制器名称	service.s7.Name_of_the_PLC:"E40"
Name_of_the_module	模块名称	service.s7.Name_of_the_module:"CPU"
Plant_identification		service.s7.Plant_identification:"WWST"
Reserved_for_operating_system	操作系统	
Module_type_name	模块类型名称	service.s7.Module_type_name:"CPU"
Serial_number_of_memory_card	存储卡序列号	service.s7.Serial_number_of_memory_card:"MMC"
OEM_ID_of_a_module	模块的 oem id	
Location_designation_of_a_module		
0x26 smb
协议说明
SMB（Server Message Block）通信协议是微软（Microsoft）和英特尔(Intel)在 1987 年制定的协议，主要是作为 Microsoft 网络的通讯协议。

字段说明
字段	字段含义	搜索语法示例
ServerDefaultDialect	服务返回的默认版本	service.smb.ServerDefaultDialect:"SMB 3.0"
ListDialects	服务器支持的 SMB 协议版本	service.smb.ListDialects:"SMB 3.1.1"
Capabilities	smb 服务器支持的功能	service.smb.Capabilities:"large-readx"
Authentication	smb 服务器认证开启情况	service.smb.Authentication:disabled
ServerOS	操作系统版本	service.smb.ServerOS:"Windows 6.1"
ServerDomain	域名称	service.smb.ServerDomain:"GFI"
ServerDNSDomainName	dns 域名称	
RemoteName	计算机名	service.smb.RemoteName:WATTSNETSTORAGE
listShares	smb Shares 信息	
0x27 tls
协议说明
TLS 记录协议是一种分层协议。 每一层中的信息可能包含长度、描述和内容等字段。 记录协议支持信息传输、将数据分段到可处理块、压缩数据、应用 MAC 、加密以及传输结果等。 对接收到的数据进行解密、校验、解压缩、重组等，然后将它们传送到高层客户机。

字段说明
字段	字段含义	搜索语法示例
tls_AKID 或 tls_authority_key_id	颁发机构密钥标识符	tls_AKID:"142eb317b75856cbae500940e61faf9d8b14c2c6"
tls_SAN 或 tls_subject_alt_name	主体可选名称	tls_SAN:"baidu.com"
tls_SKID 或 tls_subject_key_id	主体密钥标识符	tls_SKID:"9ec979d7e95bab8a16cc328ec699e69f20423587"
tls_md5	证书哈希 md5	tls_md5:"539b071cf7d2f02b1c85cc09da1186e5"
tls_sha1	证书哈希 sha1	tls_sha1:"fcb40a45f27eb391adb13f34a625968735ceddcb"
tls_sha256	证书哈希 sha256	tls_sha256:"2ed189349f818f3414132ebea309e36f620d78a0507a2fa523305f275062d73c"
tls_SPKI 或 tls_subject_key_info_sha256	公钥哈希 sha256	tls_SPKI:"ff9e7ca5dd58e557ab72fd59a12a8eac9583b21f6c4cc12894ce93f1cb0bb9c4"
tls_SN 或 tls_serial_number	证书序列号	tls_SN:"322522163434965920213346971099979782616521"
tls_issuer	签发者	tls_issuer:"O=GlobalSign"
tls_issuer_CN 或 tls_issuer_common_name	签发者通用名	tls_issuer_CN:"OV SSL"
tls_issuer_C 或 tls_issuer_country	签发者所属国家	tls_issuer_C:"US"
tls_issuer_O 或 tls_issuer_organization	签发者所属组织	tls_issuer_O:"GlobalSign"
tls_subject	主体	tls_subject:"O=GlobalSign"
tls_subject_CN 或 tls_subject_common_name	主体通用名	tls_subject_CN:"baidu.com"
tls_subject_C 或 tls_subject_country	主体所属国家	tls_subject_C:"US"
tls_subject_O 或 tls_subject_organization	主体所属组织	tls_subject_O:"GlobalSign"
tls_server_version	服务端协议版本	tls_server_version:"TLSv1.2"
tls_client_version	客户端协议版本	tls_client_version:"TLSv1.2"
browser_trusted	证书是否可信	browser_trusted:true

第4章 API接口
4.1 使用说明
0x01 API-KEY凭证获取
 登录Quake系统，点击右上角昵称，在出现的下拉框中选择 个人中心，点击进入 个人中心，可以看到下面界面：
个人中心 -> API Key

箭头指向的红色框内即为{API-KEY}

所有公开API接口均使用API Key进行身份认证。
API Key与用户身份进行绑定，调用接口时会对用户权限进行验证，若用户缺少接口所需权限，则不能调用该接口。
注意此Key是每个用户独有的，请勿私自泄漏给他人使用
0x02 接口请求Header设置
当用户取得API Key之后，需要在请求接口时，添加X-QuakeToken: API Key到HTTP Header即可。

针对POST请求，还需要指定请求包内容类型为JSON，即：添加Content-Type: application/json到请求HTTP Header即可。

接口请求示例 - CURL

curl -X POST -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" https://quake.360.net/api/v3/search/quake_service -d '{"query": "port: 443", "start": 0, "size": 10}'
其中：

-X POST：采用POST方式访问接口
-H "X-QuakeToken: {API Key}"：添加X-QuakeToken到HTTP Header，其内容为用户的API Key
-H "Content-Type: application/json"：当请求方式为POST时，须指定请求内容的类型为JSON
https://quake.360.net/api/v3/search/query_string/quake_service：具体请求的接口网址
-d '{"query": "port: 443", "start": 0, "size": 10}'：POST请求时，请求数据具体内容，以JSON的格式
接口请求示例 - Python

import requests

headers = {
    "X-QuakeToken": "用户API Key"
}

data = {
    "query": "port: 443",
    "start": 0,
    "size": 10
}

response = requests.post(url="https://quake.360.net/api/v3/search/quake_service", headers=headers, json=data)
print(response.json())
0x03 接口返回统一数据格式
字段	类型	是否必须	备注	内容
code	int	Y	请求状态码	若为0，则请求成功，非0则请求失败
message	string	Y	请求信息	若请求状态码code = 0，则返回Successful；若code != 0，则返回相应的错误信息
data	object	N	具体数据字段	接口返回的所有数据都会在该字段里
meta	object	N	额外信息字段	提供一些接口返回的额外信息，比如分页信息
错误码列表
Code	错误说明
q3004	验证码验证错误
q3005	访问已被限速，请输入验证码
q3007	用户 A 积分不足，当前积分：B
u3009	缺少 A 请求参数
u3010	A 参数应为 B 类型
q3011	用户缺少必要权限，请联系管理员 quake@360.cn
q3015	查询语句解析错误：A
q3017	暂不支持该字段查询。[A]
0x04 接口调用积分使用说明
每个月不同等级用户会得到相应等级的免费API调用次数福利，你可以在个人中心中查看月度剩余免费查询次数。
如果免费API次数消耗完毕后，通过API调用的资产数量，会花费同等数量的积分（即1条资产=1积分），望大家注意自己的积分是否充足！
0x05 用户信息
接口地址：/api/v3/user/info
请求方式：GET
接口描述：​ 获取用户详情
接口参数
​ Headers

字段	类型	必填	示例	备注
X-QuakeToken	str	是	d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx	用户API调用私钥
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/user/info" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(url="https://quake.360.net/api/v3/user/info", headers=headers)
print(response.json())
返回值范例
{
  "code": 0,
  "message": "Successful",
  "data": {
    "id": "5ea7e45147bc09xxxxxxxxcb",
    "user": {
      "id": "5ea7e45147bc09xxxxxxxxc8",
      "username": "xxxxxxx",
      "fullname": "XX",
      "email": "xxxxxx@360.cn"
    },
    "baned": false,
    "ban_status": "使用中",
    "credit": 5000,
    "persistent_credit": 1000,
    "token": "xxxx-xxxx",
    "mobile_phone": "",
    "source": "quake",
    "privacy_log": {
      "status": false,
      "time": null
    },
    "enterprise_information": {
      "name": null,
      "email": null,
      "status": "未认证"
    },
    "personal_information_status": false,
    "role": [
      {
        "fullname": "注册用户",
        "priority": 4,
        "credit": 3000
      }
    ]
  },
  "meta": {}
}
0x06 服务数据接口
服务数据接口列表
接口名	请求地址
获取服务数据筛选字段	/api/v3/filterable/field/quake_service
服务数据实时查询	/api/v3/search/quake_service
服务数据深度查询	/api/v3/scroll/quake_service
获取聚合数据筛选字段	/api/v3/aggregation/quake_service
聚合信息查询	/api/v3/aggregation/quake_service
服务数据接口详细说明
获取服务数据筛选字段接口
接口地址：/api/v3/filterable/field/quake_service
请求方式：GET
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/filterable/field/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(
    url="https://quake.360.net/api/v3/filterable/field/quake_service", headers=headers
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        "components.product_level",
        "components.product_catalog",
        "location.country_cn",
        "domain",
        "service.http.favicon.hash",
        "service.http.host",
        "components.product_vendor",
        "location.city_en",
        "service.http.title",
        "service.name",
        "time",
        "location.isp",
        "transport",
        "location.province_en",
        "components.product_name_cn",
        "asn",
        "location.city_cn",
        "location.province_cn",
        "service.http.status_code",
        "service.http.infomation.mail",
        "org",
        "service.http.icp.main_licence.unit",
        "location.district_cn",
        "service.cert",
        "service.http.server",
        "hostname",
        "service.http.body",
        "components.product_type",
        "location.district_en",
        "service.http.favicon.data",
        "ip",
        "service.http.icp.licence",
        "components.version",
        "location.country_en",
        "port",
        "service.response",
    ],
    "meta": {},
}
服务数据实时查询接口
接口地址：/api/v3/search/quake_service
请求方式：POST
该接口仅适用小批量的数据查询，若存在深度翻页查询需求（即一次性查询10W数据），请移步下面的深度查询接口。
接口参数
字段	类型	必填	默认值	备注
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
start	int	否	0	返回结果的下标切片位置
size	int	否	10	返回结果的切片长度
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
latest	bool	否	true	是否使用最新数据
shortcuts	list(str)	否	无	对应web页面里的 过滤无效请求 排除蜜罐 排除CDN （最新值请从WEB的url里获取）
仅付费用户能够指定查询时间，非付费用户默认仅查询近一年的数据
include 和 exclude参数，可传参字段从获取可筛选服务字段接口获取
注册用户：

服务数据：'ip', 'port', 'hostname', 'transport', 'asn', 'org', 'service.name', 'location.country_cn', 'location.province_cn', 'location.city_cn', 'service.http.host', 'service.http.title', 'service.http.server'
主机数据：ip、asn，org，location.country_cn，location.province_cn，location.city_cn
会员用户：

服务数据：'ip', 'port', 'hostname', 'transport', 'asn', 'org', 'service.name', 'location.country_cn', 'location.province_cn', 'location.city_cn', 'service.http.host', 'time', 'service.http.title', 'service.http.server', 'service.response', 'service.cert', 'components.product_catalog', 'components.product_type', 'components.product_level', 'components.product_vendor', 'location.country_en', 'location.province_en', 'location.city_en', 'location.district_en', 'location.district_cn', 'location.isp', 'service.http.body', 'components.product_name_cn', 'components.version', 'service.http.infomation.mail', 'service.http.favicon.hash', 'service.http.favicon.data', 'domain', 'service.http.status_code'
主机数据：ip、asn，org，location.country_cn，location.province_cn，location.city_cn，hostname，time，location.country_en，location.province_en，location.city_en，location.street_en，location.street_cn，location.owner，location.gps
使用范例
shell请求范例
curl --location 'https://quake.360.net/api/v3/search/quake_service' \
--header 'X-QuakeToken: xxxxxx' \
--header 'Content-Type: application/json' \
--data '{
    "query": " country:\"china\"",
    "start": 0,
    "size": 10,
    "ignore_cache": "False",
    "latest": "True",
    "shortcuts": [
        "610ce2adb1a2e3e1632e67b1"
    ]
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
    "query": """service: http""",
    "start": 0,
    "size": 1,
    "ignore_cache": False,
    "latest": True,
    "shortcuts": ["610ce2adb1a2e3e1632e67b1"],
}

response = requests.post(
    url="https://quake.360.net/api/v3/search/quake_service", headers=headers, json=data
)
print(response.json())
返回值范例
{
  "code": 0,
  "message": "Successful.",
  "data": [
      // 返回数据
  ],
  "meta": {
    "pagination": {
      "count": 1,
      "page_index": 1,
      "page_size": 1,
      "total": 68184
    }
  }
}
服务数据深度查询接口
接口地址：/api/v3/scroll/quake_service
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
pagination_id	str	否	无	分页id，指定分页id能够获取更多分页数据，分页id过期时间为5分钟
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	10	单次分页大小，分页大小越大，请求时间越长
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
latest	bool	否	true	是否使用最新数据
include 和 exclude参数，可传参字段从获取可筛选服务字段接口获取

使用方法
不指定pagination_id，发送第一个请求request 1
第一个请求的返回包response 1中，data字段为返回的查询数据，meta.pagination_id字段为该查询的分页id
第二次发送同样的请求，并指定pagination_id为第一次请求中的pagination_id（注意：除pagination_id外的其他查询参数不能更改）
第二次请求返回值包含第二页的查询数据
循环使用pagination_id发送更多请求，获取更多页的查询数据
当pagination_id不变且data列表为空时,则代表翻到最后一页
使用范例
第一次请求shell范例
curl -X POST "https://quake.360.net/api/v3/scroll/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "size": 1,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}'
第一次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
     "query": '''service: http''',
     "start": 0,
     "size": 1,
     "ignore_cache": False,
     "latest":True,
     "shortcuts": [
        "610ce2adb1a2e3e1632e67b1"
    ],
}

response = requests.post(
    url="https://quake.360.net/api/v3/scroll/quake_service", headers=headers, json=data
)
print(response.json())
第一次返回值
{
  "code": 0,
  "message": "Successful.",
  "data": [
    // 返回数据
  ],
  "meta": {
    "total": {"value": 8078638343, "relation": "eq"},
    "pagination_id": "66c5937994f2d3e429523da4",
    }
}
第N次请求shell范例
curl -X GET "https://quake.360.net/api/v3/scroll/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "pagination_id": "66c5937994f2d3e429523da4",
    "size": 1,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}' 
第N次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
    "query": "service: http",
    "pagination_id": "66c5937994f2d3e429523da4",
    "size": 1,
    "ignore_cache": False,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14",
}

response = requests.post(
    url="https://quake.360.net/api/v3/scroll/quake_service", headers=headers, json=data
)
print(response.json())
第N次返回值
{
  "code": 0,
  "message": "Successful.",
  "data": [
    // 返回数据
  ],
  "meta": {
    "total": {"value": 8078638343, "relation": "eq"},
    "pagination_id": "66c5937994f2d3e429523da4",
    }
}
获取聚合数据筛选字段接口
接口地址：/api/v3/aggregation/quake_service
请求方式：GET
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/aggregation/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(
    url="https://quake.360.net/api/v3/aggregation/quake_service", headers=headers
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        "ip",
        "port",
        "service",
        "product",
        "os",
        "asn",
        "org",
        "title",
        "server",
        "app",
        "catalog",
        "type",
        "level",
        "vendor",
        "isp",
        "status_code",
        "powered_by",
        "meta_keywords",
        "page_type",
        "icp",
        "app_and_version",
        "service_and_version",
        "unique_ip",
        "unique_domain",
        "unique_port",
        "unique_product",
        "unique_asn",
        "unique_org",
        "unique_isp",
        "unique_title",
        "unique_server",
        "unique_app",
        "unique_catalog",
        "unique_type",
        "unique_level",
        "unique_vendor",
        "unique_country",
        "unique_province",
        "unique_city",
        "province",
        "province_cn",
        "country",
        "country_cn",
        "country_code",
        "city",
        "city_cn",
        "district",
        "district_cn",
        "province_of_china",
    ],
    "meta": {},
}
服务聚合数据查询接口
接口地址：/api/v3/aggregation/quake_service
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
query	str	是	*	查询语句（支持的字段为获取聚合数据筛选字段接口返回的字段）
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	5	每项聚合数据的个数，聚合数量越大，请求响应时间越长，最大聚合数量1w
ignore_cache	bool	否	false	是否忽略缓存
aggregation_list	List[str]	是	无	需要获取的聚合名称列表 [注：最多仅支持聚合两个字段]
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
latest	bool	否	true	是否使用最新数据
使用范例
shell请求范例
curl -X POST "https://quake.360.net/api/v3/aggregation/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
 "query": "country: China",
    "size": 1,
    "ignore_cache": false,
    "aggregation_list": ["service"],
 "start_time": "2021-01-07 00:13:14",
 "end_time": "2021-05-20 01:13:14"
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

data = {
    "query": "country: China",
    "size": 1,
    "ignore_cache": False,
    "aggregation_list": ["service"],
    "start_time": "2024-01-07 00:13:14",
    "end_time": "2024-05-20 01:13:14",
}

response = requests.post(
    url="https://quake.360.net/api/v3/aggregation/quake_service",
    headers=headers,
    json=data,
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": {"service": [{"key": "http", "doc_count": 137128183}]},
    "meta": {},
}
0x07 主机数据接口列表
接口名	请求地址
获取主机数据筛选字段	/api/v3/filterable/field/quake_host
主机数据实时查询	/api/v3/search/quake_host
主机数据深度查询	/api/v3/scroll/quake_host
获取聚合数据筛选字段	/api/v3/aggregation/quake_host
聚合数据查询	/api/v3/aggregation/quake_host
0x08 主机数据接口
获取主机数据筛选字段接口
接口地址：/api/v3/filterable/field/quake_host
请求方式：GET
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/filterable/field/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(
    url="https://quake.360.net/api/v3/filterable/field/quake_host", headers=headers
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        "location.owner",
        "location.street_cn",
        "location.country_cn",
        "org",
        "hostname",
        "ip",
        "time",
        "location.gps",
        "location.province_en",
        "location.province_cn",
        "location.street_en",
        "location.city_cn",
        "location.country_en",
        "asn",
        "location.city_en",
    ],
    "meta": {},
}
主机数据实时查询接口
接口地址：/api/v3/search/quake_host
请求方式：POST
该接口仅适用小批量的数据查询，若存在深度翻页查询需求（即一次性查询10W数据），请移步下面的深度查询接口。
接口参数
字段	类型	必填	默认值	备注
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的主机数据收藏名称
ip_list	List[str]	否	无	IP列表
start	int	否	0	返回结果的下标切片位置
size	int	否	10	返回结果的切片长度
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
仅付费用户能够指定查询时间，非付费用户默认仅查询近一年的数据
include 和 exclude参数，可传参字段从获取可筛选主机字段接口获取

使用范例
shell请求范例
curl -X POST "https://quake.360.net/api/v3/search/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
  "query": "service: http",
     "start": 20,
     "size": 1,
     "ignore_cache": false,
  "start_time": "2024-01-01 00:00:00",
  "end_time": "2024-02-01 00:00:00"
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}
data = {
    "query": "service: http",
    "start": 20,
    "size": 1,
    "ignore_cache": False,
    "start_time": "2024-01-01 00:00:00",
    "end_time": "2024-02-01 00:00:00",
}
response = requests.post(
    url="https://quake.360.net/api/v3/search/quake_host", headers=headers, json=data
)
print(response.json())
返回值范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        {
            "hostname": "",
            "org": "China Mobile",
            "ip": "112.0.219.38",
            "os_version": None,
            "os_name": None,
            "location": {
                "owner": "",
                "province_cn": "江苏省",
                "isp": "中国移动",
                "province_en": "Jiangsu",
                "country_en": "China",
                "district_cn": "连云区",
                "gps": [119.298029, 34.670621],
                "street_cn": "",
                "city_en": "Lianyungang City",
                "district_en": "Lianyun District",
                "country_cn": "中国",
                "street_en": "",
                "city_cn": "连云港市",
                "country_code": "CN",
                "asname": "CMNET-Jiangsu-AP",
                "scene_cn": "家庭宽带",
                "scene_en": "Home Broadband",
                "radius": 11.2018,
            },
            "is_ipv6": False,
            "services": [
                {
                    "product": None,
                    "components": None,
                    "port": 8084,
                    "service_id": "8148ec2fe6ce51ca8e6198ef1311759c",
                    "name": "http",
                    "cert": "",
                    "transport": "tcp",
                    "time": "2024-01-31T23:59:48.886Z",
                    "version": "",
                    "tags": None,
                }
            ],
            "time": "2024-01-31T23:59:48.886Z",
            "asn": 56046,
            "id": "112.0.219.38",
        }
    ],
    "meta": {
        "pagination": {"count": 1, "page_index": 21, "page_size": 1, "total": 5050001}
    },
}
主机数据深度查询接口
接口地址：/api/v3/scroll/quake_host
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
pagination_id	str	否	无	分页id，指定分页id能够获取更多分页数据，分页id过期时间为5分钟
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的主机数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	10	单次分页大小，分页大小越大，请求时间越长
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
include 和 exclude参数，可传参字段从获取可筛选主机字段接口获取

使用方法
不指定pagination_id，发送第一个请求request 1
第一个请求的返回包response 1中，data字段为返回的查询数据，meta.pagination_id字段为该查询的分页id
第二次发送同样的请求，并指定pagination_id为第一次请求中的pagination_id（注意：除pagination_id外的其他查询参数不能更改）
第二次请求返回值包含第二页的查询数据
循环使用pagination_id发送更多请求，获取更多页的查询数据
当pagination_id为None且data列表为空时,则代表翻到最后一页
使用范例
第一次请求shell范例
curl -X POST "https://quake.360.net/api/v3/scroll/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "size": 1,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}'
第一次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}
data = {
    "query": "service: http",
    "size": 1,
    "ignore_cache": False,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14",
}
response = requests.post(
    url="https://quake.360.net/api/v3/scroll/quake_host", headers=headers, json=data
)
print(response.json())
第一次返回值
{
    "code": 0,
    "message": "Successful.",
    "data": [
        {
            "hostname": "c-73-232-139-235.hsd1.tx.comcast.net",
            "org": "Comcast Cable Communications, LLC",
            "ip": "73.232.139.235",
            "os_version": "",
            "os_name": "",
            "location": {
                "owner": "",
                "province_cn": "德克萨斯州",
                "province_en": "Texas",
                "isp": "comcast.com",
                "country_en": "United States",
                "district_cn": "",
                "gps": [-95.369803, 29.760427],
                "street_cn": "",
                "city_en": "Houston",
                "district_en": "",
                "country_cn": "美国",
                "street_en": "",
                "city_cn": "休斯顿",
                "country_code": "US",
                "radius": 0.0,
            },
            "is_ipv6": False,
            "services": [
                {
                    "product": "",
                    "components": [
                        {
                            "product_level": "硬件设备层",
                            "product_type": ["视频监控与摄像头"],
                            "product_vendor": "Hikvision杭州海康威视数字技术股份有限公司",
                            "product_name_cn": "Hikvision海康威视网络摄像头",
                            "product_name_en": "Hikvision-camera-weblogin",
                            "id": "5edf0cff50caf815c6bffd0a",
                            "version": "",
                            "product_catalog": ["IoT物联网"],
                        }
                    ],
                    "port": 81,
                    "service_id": "60a5b7a8250e459f958946bb",
                    "name": "http",
                    "transport": "tcp",
                    "time": "2021-05-20T01:13:12.842Z",
                    "version": "",
                    "tags": [],
                }
            ],
            "time": "2021-05-20T01:13:12.842Z",
            "asn": 7922,
            "id": "73.232.139.235",
        }
    ],
    "meta": {"total": 11547482, "pagination_id": "66c594ed89004a19c1955a8c"},
}
第N次请求shell范例
> curl -X GET "https://quake.360.net/api/v3/scroll/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "pagination_id": "66c594ed89004a19c1955a8c",
    "size": 1,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}'
第N次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}
data = {
    "query": "service: http",
    "pagination_id": "66c594ed89004a19c1955a8c",
    "size": 1,
    "ignore_cache": False,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14",
}
response = requests.post(
    url="https://quake.360.net/api/v3/scroll/quake_host", headers=headers, json=data
)
print(response.json())
第N次返回值
{
  "code": 0,
  "message": "Successful.",
  "data": [
    // 返回数据
  ],
  "meta": {"total": 11547482, "pagination_id": "66c594ed89004a19c1955a8c"}
}
获取聚合数据筛选字段接口
接口地址：/api/v3/aggregation/quake_host
请求方式：GET
使用案例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/aggregation/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
}

response = requests.get(
    url="https://quake.360.net/api/v3/aggregation/quake_host", headers=headers
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        "ip",
        "port",
        "service",
        "product",
        "os",
        "asn",
        "org",
        "isp",
        "province",
        "province_cn",
        "country",
        "country_cn",
        "country_code",
        "city",
        "city_cn",
        "district",
        "district_cn",
        "province_of_china",
    ],
    "meta": {},
}
主机聚合数据查询接口
接口地址：/api/v3/aggregation/quake_host
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的主机数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	5	每项聚合数据的个数，聚合数量越大，请求响应时间越长，最大聚合数量1w
ignore_cache	bool	否	false	是否忽略缓存
aggregation_list	List[str]	是	无	需要获取的聚合名称列表 [注：最多仅支持聚合两个字段]
start_time	int	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	int	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
使用范例
shell请求范例
curl -X POST "https://quake.360.net/api/v3/aggregation/quake_host" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
 "query": "country: China",
     "size": 1,
     "ignore_cache": false,
     "aggregation_list": ["service"],
 "start_time": "2021-01-07 00:13:14",
 "end_time": "2021-05-20 01:13:14"
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}
data = {
    "query": "country: China",
    "size": 1,
    "ignore_cache": False,
    "aggregation_list": ["service"],
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14",
}
response = requests.post(
    url="https://quake.360.net/api/v3/aggregation/quake_host",
    headers=headers,
    json=data,
)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": {"service": [{"key": "http", "doc_count": 1247353}]},
    "meta": {},
}
0x09 favicon相似度查询接口
接口地址：/api/v3/query/similar_icon/aggregation
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
favicon_hash	str	是		favicon的MD5值
similar	float	是	0.9	相似度，范围0-1
size	int	否	10	返回数量，最多支持50条数据返回
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
shell请求范例
curl -X POST "https://quake.360.net/api/v3/query/similar_icon/aggregation" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
     "favicon_hash": "827fd6c561d4b1f932f75e0f9a17f766",
     "similar": 0.9,
     "size": 1,
     "ignore_cache": false,
     "start_time": "2021-01-01 00:00:00",
     "end_time": "2021-02-01 00:00:00"
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

data = {
    "favicon_hash": "827fd6c561d4b1f932f75e0f9a17f766",
    "similar": 0.9,
    "size": 1,
    "ignore_cache": "true",
    "start_time": "2024-07-01 00:00:00",
    "end_time": "2024-07-02 00:00:00",
}

response = requests.post(
    url="https://quake.360.net/api/v3/query/similar_icon/aggregation",
    headers=headers,
    json=data,
)
print(response.json())
返回值范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        {
            "key": "827fd6c561d4b1f932f75e0f9a17f766",
            "doc_count": 84622,
            "data": "AAABAAEAICAAAAEAIADSAgAAFgAAAIlQTkcNChoKAAAADUlIRFIAAAAgAAAAIAgGAAAAc3p69AAAAplJREFUWIXt1j2IHGUYB/DfOzdnjIKFkECIVWIKvUFsIkRExa9KJCLaWAgWJx4DilZWgpDDiI0wiViIoGATP1CCEDYHSeCwUBBkgiiKURQJFiLo4d0eOxYzC8nsO9m9XcXC+8MW+3z+9/l6l2383xH+iSBpElyTdoda26xsDqp/h0CVZ3vwKm7tMBngAs7h7eRYebG6hMtMBHbMBX89vfARHprQ5U8cwdFQlIOZCVR5di1+w/wWXT/EY6EoN5NZCODuKZLDwzgSMCuBe2fwfX6QZwtpWzqfBBtLC3txF/ZhxKbBGx0EfsTJS77vwmGjlZrD4mUzUOXZjVjGI65cnTXchB8iupdDUb7QinsQZ7GzZftdQj2JVZ49iC/w6JjksIo7OnS9tiA5Vn6GtyK2+1MY5NkhfGDygVrBAxH5WkPuMjR7/3UsUFLl2Q68s4XkA3ws3v9zoSjX28Kr5wL1xrTxa6ou+f6OZGvqPg9v1wZeaUjcELE/DVfNhWFSvy/enOIZ9eq1sTokEMNLWI79oirP8g6fXpVnh7GEvY1sV/OJ4f0UhyKKk6EoX4x5pEkgXv6L6OM99YqNw/c4kXSwG5nkIfpLCynuiahW1GWeJHkfT4aiXO9atz1XcD6I6yLyHu6bIPk6Hg9FeYZ63y9EjBarPDvQ8VJ1nd9V3D4m+RncForyxFCQ4hSeahlej88Hefauurdwaufr5z/F/ZHAX6nL+mZE18e36IWiHLkFocqzW9QXcNz1+wUHxJ/f10JRPjvGP4pk/vj5L3F8AtufdD+/p6dJDknzX+05fDLGtife/766t9MRgFCUffWTudwE3AqBlVCUf0xLYGTQqzzbhydwJ3Y34g318J1tmX+DPBTlz9MS2MY2/nP8DTGaqeTDf30rAAAAAElFTkSuQmCC",
        }
    ],
    "meta": {},
}
4.2 用户信息接口
0x01 用户信息-获取接口
接口地址：/api/v3/user/info
请求方式：GET
接口描述：​ 获取用户详情
接口参数：
​ Headers

字段	类型	必填	示例	备注
X-QuakeToken	str	是	d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx	用户API调用私钥
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/user/info" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(url="https://quake.360.net/api/v3/user/info", headers=headers)
print(response.json())
返回值范例
{
  "code": 0,
  "message": "Successful",
  "data": {
    "id": "5ea7e45147bc09xxxxxxxxcb",
    "user": {
      "id": "5ea7e45147bc09xxxxxxxxc8",
      "username": "xxxxxxx",
      "fullname": "XX",
      "email": "xxxxxx@360.cn"
    },
    "baned": false,
    "ban_status": "使用中",
    "credit": 5000,
    "persistent_credit": 1000,
    "token": "xxxx-xxxx",
    "mobile_phone": "",
    "source": "quake",
    "privacy_log": {
      "status": false,
      "time": null
    },
    "enterprise_information": {
      "name": null,
      "email": null,
      "status": "未认证"
    },
    "personal_information_status": false,
    "role": [
      {
        "fullname": "注册用户",
        "priority": 4,
        "credit": 3000
      }
    ]
  },
  "meta": {}
}
4.3 服务数据接口
0x00 服务数据接口列表
接口名	请求地址
获取服务数据筛选字段	/api/v3/filterable/field/quake_service
服务数据实时查询	/api/v3/search/quake_service
服务数据深度查询	/api/v3/scroll/quake_service
获取聚合数据筛选字段	/api/v3/aggregation/quake_service
聚合信息查询	/api/v3/aggregation/quake_service
0x01 服务数据接口详细说明
获取服务数据筛选字段接口
接口地址：/api/v3/filterable/field/quake_service
请求方式：GET
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/filterable/field/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(url="https://quake.360.net/api/v3/filterable/field/quake_service", headers=headers)
print(response.json())
接口返回范例
{
    "code": 0,
    "message": "Successful.",
    "data": [
        "ip",
        "port",
        "hostname",
        "transport",
        "asn",
        "org",
        "service.name",
        "location.country_cn",
        "location.province_cn",
        "location.city_cn",
        "service.http.host",
        "service.http.title",
        "service.http.server",
    ],
    "meta": {},
}
服务数据实时查询接口
接口地址：/api/v3/search/quake_service
请求方式：POST
该接口仅适用小批量的数据查询，若存在深度翻页查询需求（即一次性查询10W数据），请移步下面的深度查询接口。
接口参数：
字段	类型	必填	默认值	备注
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
start	int	否	0	返回结果的下标切片位置
size	int	否	10	返回结果的切片长度
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
latest	bool	否	true	是否使用最新数据
shortcuts	list(str)	否	无	对应web页面里的 过滤无效请求 排除蜜罐 排除CDN （最新值请从WEB的url里获取）
仅付费用户能够指定查询时间，非付费用户默认仅查询近一年的数据
include 和 exclude参数，可传参字段从获取可筛选服务字段接口获取
注册用户：

服务数据：'ip', 'port', 'hostname', 'transport', 'asn', 'org', 'service.name', 'location.country_cn', 'location.province_cn', 'location.city_cn', 'service.http.host', 'service.http.title', 'service.http.server'
主机数据：ip、asn，org，location.country_cn，location.province_cn，location.city_cn
会员用户：

服务数据：'ip', 'port', 'hostname', 'transport', 'asn', 'org', 'service.name', 'location.country_cn', 'location.province_cn', 'location.city_cn', 'service.http.host', 'time', 'service.http.title', 'service.http.server', 'service.response', 'service.cert', 'components.product_catalog', 'components.product_type', 'components.product_level', 'components.product_vendor', 'location.country_en', 'location.province_en', 'location.city_en', 'location.district_en', 'location.district_cn', 'location.isp', 'service.http.body', 'components.product_name_cn', 'components.version', 'service.http.infomation.mail', 'service.http.favicon.hash', 'service.http.favicon.data', 'domain', 'service.http.status_code', 'images'
主机数据：ip、asn，org，location.country_cn，location.province_cn，location.city_cn，hostname，time，location.country_en，location.province_en，location.city_en，location.street_en，location.street_cn，location.owner，location.gps
使用范例
shell请求范例
curl --location 'https://quake.360.net/api/v3/search/quake_service' \
--header 'X-QuakeToken: xxxxxx' \
--header 'Content-Type: application/json' \
--header 'Cookie: cert_common=5f799147-f939-445a-a062-2d0a9073a47d' \
--data '{
    "query": " country:\"china\"",
    "start": 0,
    "size": 10,
    "ignore_cache": "False",
    "latest": "True",
    "shortcuts": [
        "610ce2adb1a2e3e1632e67b1"
    ]
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
     "query": '''service: http''',
     "start": 0,
     "size": 10,
     "ignore_cache": False,
     "latest":True,
     "shortcuts": [
        "610ce2adb1a2e3e1632e67b1"
    ],
}

response = requests.post(url="https://quake.360.net/api/v3/search/quake_service", headers=headers, json=data)
print(response.json())
返回值范例
{
  "code": 0,
  "message": "Successful.",
  "data": [
      // 返回数据
  ],
  "meta": {
    "pagination": {
      "count": 1,
      "page_index": 1,
      "page_size": 1,
      "total": 68184
    }
  }
}
服务数据深度查询接口
接口地址：/api/v3/scroll/quake_service
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
pagination_id	str	否	无	分页id，指定分页id能够获取更多分页数据，分页id过期时间为5分钟
query	str	是	*	查询语句
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	10	单次分页大小，分页大小越大，请求时间越长
ignore_cache	bool	否	false	是否忽略缓存
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
include	List(str)	否	无	包含字段
exclude	List(str)	否	无	排除字段
latest	bool	否	true	是否使用最新数据
include 和 exclude参数，可传参字段从获取可筛选服务字段接口获取

使用方法
不指定pagination_id，发送第一个请求request 1
第一个请求的返回包response 1中，data字段为返回的查询数据，meta.pagination_id字段为该查询的分页id
第二次发送同样的请求，并指定pagination_id为第一次请求中的pagination_id（注意：除pagination_id外的其他查询参数不能更改）
第二次请求返回值包含第二页的查询数据
循环使用pagination_id发送更多请求，获取更多页的查询数据
当pagination_id不变且data列表为空时,则代表翻到最后一页
使用范例
第一次请求shell范例
curl -X POST "https://quake.360.net/api/v3/scroll/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "size": 100,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}'
第一次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
     "query": '''service: http''',
     "start": 0,
     "size": 10,
     "ignore_cache": False,
     "latest":True,
     "shortcuts": [
        "610ce2adb1a2e3e1632e67b1"
    ],
}

response = requests.post(url="https://quake.360.net/api/v3/scroll/quake_service", headers=headers, json=data)
print(response.json())
第一次返回值
{
  "code": 0,
  "message": "Successful.",
  "data": [
    // 返回数据
  ],
  "meta": {
      "total": 10000,
      "pagination_id": "5f62d9a446fd9662c8898366"
  }
}
第N次请求shell范例
curl -X GET "https://quake.360.net/api/v3/scroll/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "service: http",
    "pagination_id": "5f62d9a446fd9662c8898366",
    "size": 100,
    "ignore_cache": false,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}' 
第N次请求python范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx",
    "Content-Type": "application/json"
}

data = {
    "query": "service: http",
    "pagination_id": "5f62d9a446fd9662c8898366",
    "size": 100,
    "ignore_cache": False,
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}

response = requests.post(url="https://quake.360.net/api/v3/scroll/quake_service", headers=headers, json=data)
print(response.json())
第N次返回值
{
  "code": 0,
  "message": "Successful.",
  "data": [
    // 返回数据
  ],
  "meta": {
      "total": 10000,
      "pagination_id": "5f62d9a446fd9662c8898366"
  }
}
获取聚合数据筛选字段接口
接口地址：/api/v3/aggregation/quake_service
请求方式：GET
使用范例
shell请求范例
curl -X GET "https://quake.360.net/api/v3/aggregation/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

response = requests.get(url="https://quake.360.net/api/v3/aggregation/quake_service", headers=headers)
print(response.json())
接口返回范例
{
  "code": 0,
  "message": "Successful.",
  "data": [
    "province",
    "country",
    "city",
    "port",
    "service",
    "product",
    "province_of_china",
    "os"
  ],
  "meta": {}
}
服务聚合数据查询接口
接口地址：/api/v3/aggregation/quake_service
请求方式：POST
接口参数
字段	类型	必填	默认值	备注
query	str	是	*	查询语句（支持的字段为获取聚合数据筛选字段接口返回的字段）
rule	str	否	无	类型为IP列表的服务数据收藏名称
ip_list	List[str]	否	无	IP列表
size	int	否	5	每项聚合数据的个数，聚合数量越大，请求响应时间越长，最大聚合数量1w
ignore_cache	bool	否	false	是否忽略缓存
aggregation_list	List[str]	是	无	需要获取的聚合名称列表 [注：最多仅支持聚合两个字段]
start_time	str	否	无	查询起始时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
end_time	str	否	无	查询截止时间，接受2020-10-14 00:00:00格式的数据，时区为UTC
latest	bool	否	true	是否使用最新数据
使用范例
shell请求范例
curl -X POST "https://quake.360.net/api/v3/aggregation/quake_service" -H "X-QuakeToken: d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx" -H "Content-Type: application/json" -d '{
    "query": "country: China",
       "size": 5,
       "ignore_cache": false,
       "aggregation_list": ["service"],
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}'
python请求范例
import requests

headers = {
    "X-QuakeToken": "d17140ae-xxxx-xxx-xxxx-c0818b2bbxxx"
}

data = {
    "query": "country: China",
    "size": 5,
    "ignore_cache": False,
    "aggregation_list": ["service"],
    "start_time": "2021-01-07 00:13:14",
    "end_time": "2021-05-20 01:13:14"
}

response = requests.post(url="https://quake.360.net/api/v3/aggregation/quake_service", headers=headers, json=data)
print(response.json())
接口返回范例
{
  "code": 0,
  "message": "Successful.",
  "data": {
    "service": [
      {
        "key": "http",
        "doc_count": 96410649
      },
      {
        "key": "ssh",
        "doc_count": 13892606
      },
      {
        "key": "smtp",
        "doc_count": 6937505
      },
      {
        "key": "https",
        "doc_count": 6903548
      },
      {
        "key": "ftp",
        "doc_count": 5958763
      }
    ]
  },
  "meta": { }
}